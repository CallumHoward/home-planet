<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <!-- <link rel="icon" href="/favicon.ico" /> -->
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1"
    />
    <link rel="stylesheet" href="index.css" />
    <title>Project Astro</title>
  </head>
  <body>
    <div id="root"></div>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <script type="module" src="dist/bundle.js"></script>

    <canvas id="myCanvas"></canvas>
    <script>
      function animate() {
        context.canvas.width  = window.innerWidth;
        context.canvas.height = window.innerHeight;
        const velocityMultiplier = 0.5;
        if (stars.length < 300 && Math.random() < 0.5) {
          // if fewer than 300 stars, a 50% chance of creating a new one
          let star = {
            x: 0,
            y: 0,
            vx: -5 + Math.random() * 10,
            vy: -5 + Math.random() * 10,
          }; // create a new star in the middle with random velocity
          stars.push(star); // add the star to the array
        }
        context.clearRect(0, 0, canvas.width, canvas.height); // clear the frame
        for (let n = 0; n < stars.length; n++) {
          // for each star
          stars[n].x = stars[n].x + stars[n].vx * velocityMultiplier; // add the velocity to the current position
          stars[n].y = stars[n].y + stars[n].vy * velocityMultiplier; // in both axles
          if (stars[n].x > context.canvas.width || stars[n].x < -context.canvas.width) {
            // if the star is out of bounds
            stars[n].x = 0; // put it back in the center
            stars[n].y = 0;
          }
          color = Math.floor((Math.abs(stars[n].x) + Math.abs(stars[n].y)) / 5);
          context.fillStyle = "rgb(" + color + "," + color + "," + color + ")"; // use the color value for the R, G and B component
          context.beginPath();
          context.arc(
            400 + stars[n].x,
            400 + stars[n].y,
            Math.abs(stars[n].y / 100 + n / 200),
            0,
            2 * Math.PI
          ); // draw a circle
          context.fill();
        }
        window.requestAnimationFrame(animate); // request another animation frame
      }

      let canvas = document.getElementById("myCanvas");
      let context = canvas.getContext("2d");
      let stars = []; // the array of stars
      window.requestAnimationFrame(animate); // initialize the animation
    </script>
  </body>
</html>
